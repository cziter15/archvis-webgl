<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Reduce aggressive caching during development / debugging on mobile devices -->
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<title>ArchVis WebGL</title>
	<link rel="icon" href="./cog.svg" type="image/svg+xml">
	<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();class Z{static architectureToXML(t){let n=`<?xml version="1.0" encoding="UTF-8"?>
`;return n+=`<arch>
`,n+=`  <node name="${t.root.name}" pos="${t.root.pos.join(",")}" color="${t.root.color}" scale="${t.root.scale}">
`,t.root.children.forEach(o=>{n+=this.nodeToXML(o,2)}),n+=`  </node>
`,t.legend&&t.legend.length>0&&(n+=`  <legend>
`,t.legend.forEach(o=>{n+=`    <entry name="${o.name}" color="${o.color}" />
`}),n+=`  </legend>
`),t.uiInfo&&t.uiInfo.title&&(n+=`  <ui-info>
`,n+=`    <title>${t.uiInfo.title}</title>
`,n+=`  </ui-info>
`),n+="</arch>",n}static nodeToXML(t,n){let o="";const r=" ".repeat(n);return o+=`${r}<node name="${t.name}" pos="${t.pos.join(",")}" color="${t.color}"`,t.scale!==void 0&&(o+=` scale="${t.scale}"`),t.children&&t.children.length>0?(o+=`>
`,t.children.forEach(s=>{o+=this.nodeToXML(s,n+2)}),o+=`${r}</node>
`):o+=` />
`,o}static xmlToArchitecture(t){const o=new DOMParser().parseFromString(t,"text/xml"),r=o.querySelector("arch > node");if(!r)throw new Error("Root element not found in XML");const s={name:r.getAttribute("name"),pos:r.getAttribute("pos").split(",").map(Number),color:r.getAttribute("color"),scale:parseFloat(r.getAttribute("scale")),children:[]};r.querySelectorAll(":scope > node").forEach(d=>{const w=this.parseNode(d);s.children.push(w)});const p=[],S=o.querySelector("arch > legend");S&&S.querySelectorAll("entry").forEach(w=>{const C={name:w.getAttribute("name"),color:w.getAttribute("color")};p.push(C)});const I={title:""},R=o.querySelector("arch > ui-info");if(R){const d=R.querySelector("title");d&&(I.title=d.textContent||"")}return{root:s,legend:p,uiInfo:I}}static parseNode(t){const n={name:t.getAttribute("name"),pos:t.getAttribute("pos").split(",").map(Number),color:t.getAttribute("color"),children:[]},o=t.getAttribute("scale");return o&&(n.scale=parseFloat(o)),t.querySelectorAll(":scope > node").forEach(s=>{const l=this.parseNode(s);n.children.push(l)}),n}}let a={root:{name:"Empty Architecture",pos:[0,0,0],color:"#666666",scale:1,children:[]},legend:[],uiInfo:{title:""}},D=!0,G=!0;if("serviceWorker"in navigator)try{navigator.serviceWorker.getRegistrations().then(e=>{e&&e.length&&console.info("Found",e.length,"service worker registrations — attempting to unregister them to avoid stale cache."),e.forEach(t=>t.unregister().then(n=>{console.info("Service worker unregistered:",n,t)}).catch(n=>console.warn("SW unregister error",n)))}).catch(e=>console.warn("Error getting SW registrations",e)),window.caches&&typeof window.caches.keys=="function"&&caches.keys().then(e=>{e.forEach(t=>{caches.delete(t).then(n=>{console.info("Cache deleted:",t,n)}).catch(n=>console.warn("Cache delete failed",t,n))})}).catch(e=>console.warn("Error listing caches",e))}catch(e){console.warn("Service worker cleanup failed",e)}window.smoothFactors||(window.smoothFactors={drag:.25,zoom:.15,general:.12});function L(e){const t=document.getElementById("messageDisplay"),n=document.createElement("div");n.className="message",n.textContent=e,t.appendChild(n),setTimeout(()=>n.remove(),5e3)}function ie(){const e=document.getElementById("legendContainer"),t=document.getElementById("legendItems");a.legend&&a.legend.length>0?(e.style.display="block",t.innerHTML="",a.legend.forEach(n=>{const o=document.createElement("div");o.className="legend-entry",o.innerHTML=`
						<div class="legend-color" style="background-color: ${n.color};"></div>
						<span style="color: white;">${n.name}</span>
					`,t.appendChild(o)})):e.style.display="none"}function ae(){const e=document.getElementById("title");e.textContent=a.uiInfo?.title||"ARCHITECTURE VISUALIZATION"}document.getElementById("saveBtn").addEventListener("click",()=>{if(a.root.name==="Empty Architecture"||!a.root.name){L("No architecture to save. Please load an architecture first.");return}const e=Z.architectureToXML(a),t=new Blob([e],{type:"application/xml"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="architecture.xml",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n),L("Architecture saved successfully!")});document.getElementById("loadBtn").addEventListener("click",()=>{document.getElementById("xmlFileInput").click()});document.getElementById("xmlFileInput").addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=o=>{try{const r=o.target.result;if(!r||r.trim()==="")throw new Error("Empty file");const s=Z.xmlToArchitecture(r);if(!s||!s.root)throw new Error("Invalid architecture structure");a={root:s.root||{name:"Unknown Root",pos:[0,0,0],color:"#ff00ff",scale:1,children:[]},legend:s.legend||[],uiInfo:s.uiInfo||{title:""}},ie(),ae(),he(),L("Architecture loaded successfully!")}catch(r){L("Error loading XML file: "+r.message)}},n.readAsText(t),e.target.value=""});document.getElementById("sampleBtn").addEventListener("click",()=>{const e=`<?xml version="1.0" encoding="UTF-8"?>
<arch>
  <node name="ROOT" pos="0,0,0" color="#00ffff" scale="1">
	<node name="API Gateway" pos="10,5,0" color="#ff00ff" scale="0.8">
	  <node name="Auth Service" pos="15,8,5" color="#ffff00" scale="0.6" />
	  <node name="Rate Limiter" pos="15,8,-5" color="#ffff00" scale="0.6" />
	</node>
	<node name="Database Layer" pos="-10,5,0" color="#00ff00" scale="0.8">
	  <node name="Primary DB" pos="-15,8,5" color="#ffff00" scale="0.6" />
	  <node name="Cache" pos="-15,8,-5" color="#ffff00" scale="0.6" />
	</node>
	<node name="Workers" pos="0,-5,10" color="#ff6600" scale="0.8">
	  <node name="Job Queue" pos="5,-8,15" color="#ffff00" scale="0.6" />
	  <node name="Worker Pool" pos="-5,-8,15" color="#ffff00" scale="0.6" />
	</node>
  </node>
  <legend>
	<entry name="Core Services" color="#00ffff" />
	<entry name="Modules" color="#ff00ff" />
	<entry name="Components" color="#ffff00" />
	<entry name="Data Layer" color="#00ff00" />
  </legend>
  <ui-info>
	<title>MICROSERVICES ARCHITECTURE</title>
  </ui-info>
</arch>`;try{a=Z.xmlToArchitecture(e),ie(),ae(),he(),L("Sample architecture loaded successfully!")}catch(t){L("Error loading sample: "+t.message)}});const _=document.getElementById("mobileSaveBtn"),ee=document.getElementById("mobileLoadBtn"),te=document.getElementById("mobileSampleBtn");_&&_.addEventListener("click",()=>document.getElementById("saveBtn").click());ee&&ee.addEventListener("click",()=>document.getElementById("xmlFileInput").click());te&&te.addEventListener("click",()=>document.getElementById("sampleBtn").click());document.getElementById("smoothnessSlider").addEventListener("change",e=>{const n=.55-parseFloat(e.target.value);window.smoothFactors={drag:n,zoom:n*.8,general:n*1.2};const o=Math.round((.55-n)/.45*100);L(`Smoothness set to ${o}%`)});document.addEventListener("keydown",e=>{e.key.toLowerCase()==="u"&&(D=!D,document.getElementById("rightPanel").style.display=D?"block":"none",document.getElementById("leftPanel").style.display=D?"block":"none",document.getElementById("uiToggle").classList.toggle("visible",!D)),e.key.toLowerCase()==="q"&&(G=!G,document.body.style.cursor=G?"default":"none",L(`Cursor ${G?"visible":"hidden"}`))});const u=new THREE.Scene;u.fog=new THREE.FogExp2(1296,.008);const y=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.1,1e3);y.position.set(0,15,50);y.lookAt(0,0,0);const X=new THREE.WebGLRenderer({antialias:!0,alpha:!0});X.setSize(window.innerWidth,window.innerHeight);X.setClearColor(1296);document.getElementById("canvas").appendChild(X.domElement);const Re=new THREE.AmbientLight(1710654,.8);u.add(Re);const ce=new THREE.PointLight(65535,1.5,60);ce.position.set(15,15,15);u.add(ce);const le=new THREE.PointLight(16711935,1.5,60);le.position.set(-15,10,-15);u.add(le);const de=new THREE.PointLight(16777215,1,40);de.position.set(0,20,0);u.add(de);const ue=new THREE.GridHelper(100,100,65535,657966);ue.position.y=-18;u.add(ue);const $=[],z=[];function be(e,t){const n=document.createElement("canvas"),o=n.getContext("2d");n.width=1024,n.height=128,o.clearRect(0,0,n.width,n.height),o.font="54px Orbitron, sans-serif",o.textAlign="center",o.textBaseline="middle",o.shadowColor=t,o.shadowBlur=15,o.fillStyle=t,o.fillText(e.toUpperCase(),n.width/2,n.height/2);const r=new THREE.CanvasTexture(n);r.needsUpdate=!0;const s=new THREE.PlaneGeometry(4.5,.56),l=new THREE.MeshBasicMaterial({map:r,transparent:!0,side:THREE.DoubleSide,depthTest:!0}),p=new THREE.Mesh(s,l),S=new THREE.PlaneGeometry(4.6,.66),I=new THREE.MeshBasicMaterial({color:1296,transparent:!0,opacity:.8,side:THREE.DoubleSide}),R=new THREE.Mesh(S,I);R.position.z=-.05;const d=new THREE.Group;d.add(R),d.add(p);const w=new THREE.EdgesGeometry(new THREE.PlaneGeometry(4.6,.66)),C=new THREE.LineBasicMaterial({color:t,linewidth:2}),H=new THREE.LineSegments(w,C);return d.add(H),d}function fe(e,t,n,o=1){const r=new THREE.Group,s=new THREE.Group,l=new THREE.BoxGeometry(.6*o,.6*o,.6*o),p=new THREE.EdgesGeometry(l),S=new THREE.LineBasicMaterial({color:n,linewidth:2}),I=new THREE.LineSegments(p,S);s.add(I);const R=new THREE.BoxGeometry(.4*o,.4*o,.4*o),d=new THREE.MeshBasicMaterial({color:n,transparent:!0,opacity:.3,wireframe:!0}),w=new THREE.Mesh(R,d);s.add(w);const C=new THREE.PointLight(n,.5,5);s.add(C),r.add(s);try{const H=be(e,n);H.position.y=1.5*o,r.add(H)}catch(H){console.warn("Failed to create text mesh:",H)}return r.position.set(...t),r.userData={name:e,rotationSpeed:Math.random()*.01+.005,rotatingGroup:s},u.add(r),$.push(r),r}function Me(e,t,n,o=.5){const r=[new THREE.Vector3(...e),new THREE.Vector3(...t)],s=new THREE.BufferGeometry().setFromPoints(r),l=new THREE.LineBasicMaterial({color:n,transparent:!0,opacity:o}),p=new THREE.Line(s,l);u.add(p),z.push(p)}function me(e,t,n,o){e.forEach(r=>{if(r.name){const s=fe(r.name,r.pos,r.color,r.scale||1);Me(n,r.pos,o),r.children&&r.children.length>0&&me(r.children,s,r.pos,r.color)}})}function he(){if($.forEach(e=>u.remove(e)),z.forEach(e=>u.remove(e)),$.length=0,z.length=0,a.root.name&&a.root.name!=="Empty Architecture"){const e=fe(a.root.name,a.root.pos,a.root.color,a.root.scale);a.root.children&&a.root.children.length>0&&me(a.root.children,e,a.root.pos,a.root.color)}}const pe=new THREE.BufferGeometry,ge=1500,Ee=new Float32Array(ge*3);for(let e=0;e<ge*3;e++)Ee[e]=(Math.random()-.5)*100;pe.setAttribute("position",new THREE.BufferAttribute(Ee,3));const Se=new THREE.PointsMaterial({size:.05,color:65535,transparent:!0,opacity:.6}),K=new THREE.Points(pe,Se);u.add(K);const c={w:!1,a:!1,s:!1,d:!1,shift:!1,space:!1},i={leftTouchId:null,rightTouchId:null,leftStart:null,rightStart:null,leftPos:{x:0,y:0},rightPos:{},maxRadius:44};i.upPressed=!1;i.downPressed=!1;let h=0,U=0,F=50,b=50,j=15,M=15,O=0,v=0,Y=0,B=0,N=0,T=0,W=!1,V=!1,A=0,P=0,q=!0,ne,oe=0;function J(){clearTimeout(ne),ne=setTimeout(()=>{q=!0},3e3)}document.addEventListener("keydown",e=>{const t=e.key.toLowerCase();t==="w"&&(c.w=!0),t==="a"&&(c.a=!0),t==="s"&&(c.s=!0),t==="d"&&(c.d=!0),e.key==="Shift"&&(c.shift=!0),e.key===" "&&(c.space=!0),e.key==="Escape"&&document.pointerLockElement===document.getElementById("canvas")&&document.exitPointerLock()});document.addEventListener("keyup",e=>{const t=e.key.toLowerCase();t==="w"&&(c.w=!1),t==="a"&&(c.a=!1),t==="s"&&(c.s=!1),t==="d"&&(c.d=!1),e.key==="Shift"&&(c.shift=!1),e.key===" "&&(c.space=!1)});document.addEventListener("mousedown",e=>{e.button===0?(W=!0,A=e.clientX,P=e.clientY,q=!1):(e.button===1||e.button===2)&&(e.preventDefault(),V=!0,A=e.clientX,P=e.clientY,q=!1)});document.addEventListener("mouseup",()=>{W=!1,V=!1});const f=document.getElementById("leftStick"),m=document.getElementById("rightStick"),ye=f&&f.querySelector(".stick-knob"),we=m&&m.querySelector(".stick-knob");function re(e,t,n){e&&(e.style.transform=`translate(${t}px, ${n}px)`)}function se(e){e&&(e.style.transition="transform 150ms ease-out",e.style.transform="translate(0, 0)",setTimeout(()=>e.style.transition="",160))}function ve(e){J();for(const t of Array.from(e.changedTouches)){const n=document.elementFromPoint(t.clientX,t.clientY);f&&(n===f||f.contains(n))?(i.leftTouchId=t.identifier,i.leftStart={x:t.clientX,y:t.clientY},i.leftPos={x:0,y:0}):m&&(n===m||m.contains(n))&&(i.rightTouchId=t.identifier,i.rightStart={x:t.clientX,y:t.clientY},i.rightPos={x:0,y:0})}}function Te(e){for(const t of Array.from(e.changedTouches))if(t.identifier===i.leftTouchId){const n=t.clientX-i.leftStart.x,o=t.clientY-i.leftStart.y,r=Math.hypot(n,o)||1,s=n/r*Math.min(r,i.maxRadius),l=o/r*Math.min(r,i.maxRadius);i.leftPos={x:s,y:l},re(ye,s,l)}else if(t.identifier===i.rightTouchId){const n=t.clientX-i.rightStart.x,o=t.clientY-i.rightStart.y;U-=n*.008,M+=o*.12,M=Math.max(-20,Math.min(35,M)),i.rightStart={x:t.clientX,y:t.clientY},re(we,n*.6,o*.6)}}function Q(e){for(const t of Array.from(e.changedTouches))t.identifier===i.leftTouchId&&(i.leftTouchId=null,i.leftStart=null,i.leftPos={x:0,y:0},se(ye)),t.identifier===i.rightTouchId&&(i.rightTouchId=null,i.rightStart=null,se(we))}let k=null;function xe(e,t){const n=e.clientX-t.clientX,o=e.clientY-t.clientY;return Math.hypot(n,o)}function Ie(e){if(e.touches.length===2){const t=xe(e.touches[0],e.touches[1]);k==null&&(k=t);const n=t-k;b-=n*.03,b=Math.max(15,Math.min(100,b)),k=t}}function He(e){e.touches.length<2&&(k=null)}f&&f.addEventListener("touchstart",ve,{passive:!0});f&&f.addEventListener("touchmove",Te,{passive:!1});f&&f.addEventListener("touchend",Q,{passive:!0});m&&m.addEventListener("touchstart",ve,{passive:!0});m&&m.addEventListener("touchmove",Te,{passive:!1});m&&m.addEventListener("touchend",Q,{passive:!0});document.addEventListener("touchstart",e=>{e.touches.length===2&&(k=xe(e.touches[0],e.touches[1])),J()},{passive:!0});document.addEventListener("touchmove",e=>{e.touches.length===2&&Ie(e),e.touches.length>=1&&e.preventDefault()},{passive:!1});document.addEventListener("touchend",e=>{Q(e),He(e)},{passive:!0});const g=document.getElementById("btnUp"),E=document.getElementById("btnDown");function x(e,t){e&&e.classList.toggle("active",t)}g&&(g.addEventListener("touchstart",e=>{e.preventDefault(),i.upPressed=!0,x(g,!0)},{passive:!1}),g.addEventListener("touchend",e=>{e.preventDefault(),i.upPressed=!1,x(g,!1)},{passive:!0}),g.addEventListener("mousedown",()=>{i.upPressed=!0,x(g,!0)}),g.addEventListener("mouseup",()=>{i.upPressed=!1,x(g,!1)}));E&&(E.addEventListener("touchstart",e=>{e.preventDefault(),i.downPressed=!0,x(E,!0)},{passive:!1}),E.addEventListener("touchend",e=>{e.preventDefault(),i.downPressed=!1,x(E,!1)},{passive:!0}),E.addEventListener("mousedown",()=>{i.downPressed=!0,x(E,!0)}),E.addEventListener("mouseup",()=>{i.downPressed=!1,x(E,!1)}));document.addEventListener("contextmenu",e=>e.preventDefault());document.addEventListener("mousemove",e=>{if(W){const t=e.clientX-A,n=e.clientY-P;U-=t*.008,M+=n*.15,M=Math.max(-20,Math.min(35,M)),A=e.clientX,P=e.clientY}else if(V){const t=e.clientX-A,n=e.clientY-P,o=new THREE.Vector3(Math.cos(h),0,-Math.sin(h)),r=.08;v+=o.x*t*r,T+=o.z*t*r,B-=n*r,A=e.clientX,P=e.clientY}});document.addEventListener("wheel",e=>{e.preventDefault();const t=e.deltaY*.03;b+=t,b=Math.max(15,Math.min(100,b))},{passive:!1});function Le(){requestAnimationFrame(Le),oe++,q&&(U+=.001),(W||V)&&J();const e=window.smoothFactors||{drag:.25,zoom:.15,general:.12};h+=(U-h)*e.drag,F+=(b-F)*e.zoom,j+=(M-j)*e.drag,O+=(v-O)*e.general,Y+=(B-Y)*e.general,N+=(T-N)*e.general;const t=new THREE.Vector3(-Math.sin(h),0,-Math.cos(h)),n=new THREE.Vector3(Math.cos(h),0,-Math.sin(h)),o=.3;if(i.leftPos){const r=i.leftPos.x/i.maxRadius,s=-i.leftPos.y/i.maxRadius;Math.abs(r)>.12&&(v+=n.x*r*o*.8,T+=n.z*r*o*.8),Math.abs(s)>.12&&(v+=t.x*s*o*.8,T+=t.z*s*o*.8)}c.w&&(v+=t.x*o,T+=t.z*o),c.s&&(v-=t.x*o,T-=t.z*o),c.a&&(v-=n.x*o,T-=n.z*o),c.d&&(v+=n.x*o,T+=n.z*o),c.space&&(B+=o),c.shift&&(B-=o),i.upPressed&&(B+=o*.9),i.downPressed&&(B-=o*.9),y.position.x=O+Math.sin(h)*F,y.position.z=N+Math.cos(h)*F,y.position.y=Y+j,y.lookAt(O,Y,N),$.forEach(r=>{r.userData.rotatingGroup&&(r.userData.rotatingGroup.rotation.y+=r.userData.rotationSpeed,r.userData.rotatingGroup.rotation.x+=r.userData.rotationSpeed*.5)}),z.forEach((r,s)=>{r.material.opacity=.3+Math.sin(oe*.05+s)*.2}),K.rotation.y+=3e-4,K.rotation.x+=1e-4,X.render(u,y)}Le();window.addEventListener("resize",()=>{y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),X.setSize(window.innerWidth,window.innerHeight)});</script>
  <style rel="stylesheet" crossorigin>*{margin:0;padding:0;box-sizing:border-box}body{width:100%;height:100vh;background:linear-gradient(to bottom,#000,#2a1a3e,#000);font-family:Orbitron;overflow:hidden;cursor:default}#canvas{width:100%;height:100%;display:block}.ui-container{position:absolute;inset:0;pointer-events:auto}.message-display{position:fixed;bottom:24px;left:50%;transform:translate(-50%);z-index:50;pointer-events:none}.message{font-family:monospace;color:#0ff;font-size:12px;background:#00000080;padding:8px 12px;border:1px solid #00ffff;margin:8px 0;animation:fadeOut 5s forwards;pointer-events:auto;cursor:pointer}@keyframes fadeOut{0%{opacity:1}80%{opacity:1}to{opacity:0}}.title{position:absolute;top:24px;left:50%;transform:translate(-50%);color:#f0f;font-size:24px;font-weight:700;animation:pulse 2s infinite;pointer-events:none}@keyframes pulse{0%,to{opacity:1}50%{opacity:.5}}.left-panel{position:absolute;top:24px;left:24px;color:#0ff;font-size:14px;pointer-events:auto;width:256px}.panel-box{background:#000000b3;padding:16px;border:1px solid #00ffff;width:100%}.legend{margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid #00ffff}.legend-title{font-size:12px;color:#0cf;margin-bottom:8px}.legend-entry{display:flex;align-items:center;gap:8px;font-size:12px;margin-bottom:4px}.legend-color{width:12px;height:12px;border:1px solid rgba(255,255,255,.2);border-radius:2px}.controls-text{font-size:12px;color:#0cf;line-height:1.6}.right-panel{position:absolute;top:24px;right:24px;color:#0ff;font-size:14px;pointer-events:all;width:256px}.button{width:100%;color:#0ff;font-size:12px;background:#00000080;padding:8px 12px;border:1px solid #00ffff;margin-bottom:8px;cursor:pointer;text-align:center;transition:all .2s}.button:hover{background:#0ff3;color:#fff;border-color:#0cf}.smoothness-control{margin-top:16px;padding-top:12px;border-top:1px solid #00ffff}.smoothness-label{font-size:12px;color:#0cf;margin-bottom:8px}.slider-container{display:flex;align-items:center;gap:8px;margin-bottom:8px}.slider-container span{font-size:12px;color:#fff}input[type=range]{flex:1;height:8px;background:#001a4d;border-radius:4px;appearance:none;-webkit-appearance:none;cursor:pointer}input[type=range]::-webkit-slider-thumb{appearance:none;-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:#0ff;cursor:pointer;border:1px solid #ffffff}input[type=range]::-moz-range-thumb{width:16px;height:16px;border-radius:50%;background:#0ff;cursor:pointer;border:1px solid #ffffff}.author-info{font-size:12px;color:#0ff;text-align:center;margin-top:4px}.author-info a{color:#fff;text-decoration:none}.author-info a:hover{text-decoration:underline;color:#fff}.author-info a:visited,.author-info a:active,.author-info a:focus{color:#fff;text-decoration:none}.hidden-input{display:none}.ui-toggle{position:absolute;bottom:24px;left:24px;color:#0ff;font-size:12px;background:#00000080;padding:8px 12px;border:1px solid #00ffff;pointer-events:auto;display:none}.ui-toggle.visible{display:block}.mobile-controls{position:absolute;inset:0 0 18px;pointer-events:none}.stick{width:120px;height:120px;border-radius:50%;background:#0006;border:2px solid rgba(0,255,255,.12);position:absolute;pointer-events:auto;touch-action:none;display:flex;align-items:center;justify-content:center}.stick-knob{width:44px;height:44px;border-radius:50%;background:#00ffffe6;transform:translate(0)}.left-stick{left:18px;bottom:18px}.right-stick{right:18px;bottom:18px}.action-buttons{position:absolute;right:18px;bottom:150px;display:flex;flex-direction:column;gap:8px;pointer-events:auto}.action-btn{width:56px;height:40px;border-radius:8px;background:#0009;color:#0ff;border:1px solid #00ffff;font-size:18px;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation}@media(min-width:900px){.mobile-controls{display:none}}@media(max-width:899px){.ui-container .left-panel,.ui-container .right-panel,.title{display:none}.mobile-controls{display:block}}.mobile-menu{position:absolute;left:50%;transform:translate(-50%);bottom:18px;display:flex;gap:8px;pointer-events:auto;z-index:60}.mobile-action{z-index:70}.mobile-action{width:48px;height:48px;border-radius:10px;background:#000000b3;color:#0ff;border:1px solid #00ffff;font-size:18px;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation}@media(min-width:900px){.mobile-menu{display:none}}</style>
</head>
<body>
	<div id="canvas"></div>
	<div class="ui-container">
		<div class="title" id="title">ARCHITECTURE VISUALIZATION</div>
		<div class="left-panel" id="leftPanel">
			<div class="panel-box">
				<div class="legend" id="legendContainer" style="display: none;">
					<div class="legend-title">LEGEND:</div>
					<div id="legendItems"></div>
				</div>
				<div class="controls-text">
					ORBIT MODE<br>
					LEFT DRAG - ROTATE VIEW<br>
					RIGHT/MIDDLE DRAG - PAN<br>
					SCROLL - ZOOM<br>
					WASD - MOVE CAMERA<br>
					SPACE/SHIFT - UP/DOWN<br>
					AUTO-ROTATES AFTER 3s
					<div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #00ffff;">
						<span style="color: #ffff00;">U</span> - TOGGLE UI<br>
						<span style="color: #ffff00;">Q</span> - TOGGLE CURSOR
					</div>
				</div>
			</div>
		</div>
		<div class="right-panel" id="rightPanel">
			<div class="panel-box">
				<button class="button" id="saveBtn">💾 SAVE</button>
				<button class="button" id="loadBtn">📁 LOAD</button>
				<button class="button" id="sampleBtn">📋 SAMPLE</button>
				<div class="smoothness-control">
					<div class="smoothness-label">SMOOTHNESS:</div>
					<div class="slider-container">
						<span>MIN</span>
						<input type="range" id="smoothnessSlider" min="0.05" max="0.5" step="0.05" value="0.15">
						<span>MAX</span>
					</div>
					<div class="author-info">
						© <a href="https://github.com/cziter15" target="_blank">K. STREHLAU</a>
					</div>
				</div>
			</div>
		</div>
		<div class="message-display" id="messageDisplay"></div>
		<div class="ui-toggle" id="uiToggle">Press U to show UI</div>
	</div>
	<!-- Mobile controls -->
	<div id="mobileControls" class="mobile-controls" aria-hidden="true">
		<div id="leftStick" class="stick left-stick" aria-label="move joystick">
			<div class="stick-knob"></div>
		</div>
		<div id="rightStick" class="stick right-stick" aria-label="look joystick">
			<div class="stick-knob"></div>
		</div>
		<div class="action-buttons">
			<button id="btnUp" class="action-btn">▲</button>
			<button id="btnDown" class="action-btn">▼</button>
		</div>
	</div>

	<!-- Mobile menu: quick actions for small screens -->
	<div class="mobile-menu" id="mobileMenu">
		<button id="mobileSaveBtn" class="mobile-action">💾</button>
		<button id="mobileLoadBtn" class="mobile-action">📁</button>
		<button id="mobileSampleBtn" class="mobile-action">📋</button>
	</div>
	<input type="file" id="xmlFileInput" class="hidden-input" accept=".xml">
</body>
</html>
